"use strict";(self["webpackChunksakai_vue"]=self["webpackChunksakai_vue"]||[]).push([[184],{9208:function(e,a,t){t.d(a,{c:function(){return i}});class i{getPaidLeaves(e){var a="";if(e){a="page="+(e.page+1)+"&per_page="+e.rows;var t=1==e.sortOrder?"asc":"desc";a+="&order_by="+t,null!=e.sortField&&(a+="&sort_by="+e.sortField),e.filters.global.value&&(a+="&keyword="+e.filters.global.value)}return fetch("https://sisapa.tanjungbalaikota.go.id/api/paid_leaves?"+a,{headers:{authorization:"Bearer "+localStorage.getItem("presence_app_token")}}).then((e=>401==e.status?{data:{redirectTo:"login"}}:e.json())).then((e=>e.data))}getPaidLeave(e){return fetch("https://sisapa.tanjungbalaikota.go.id/api/paid_leaves/"+e,{headers:{authorization:"Bearer "+localStorage.getItem("presence_app_token")}}).then((e=>401==e.status?{data:{redirectTo:"login"}}:e.json())).then((e=>e.data))}createPaidLeave(e){return fetch("https://sisapa.tanjungbalaikota.go.id/api/paid_leaves/",{method:"POST",headers:{authorization:"Bearer "+localStorage.getItem("presence_app_token"),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:e.name})}).then((e=>401==e.status?{redirectTo:"Login"}:e.json()))}updatePaidLeave(e){return fetch("https://sisapa.tanjungbalaikota.go.id/api/paid_leaves/"+e.id,{method:"PUT",headers:{authorization:"Bearer "+localStorage.getItem("presence_app_token"),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:e.name})}).then((e=>401==e.status?{redirectTo:"Login"}:e.json()))}deletePaidLeave(e){return fetch("https://sisapa.tanjungbalaikota.go.id/api/paid_leaves/"+e.id,{method:"DELETE",headers:{authorization:"Bearer "+localStorage.getItem("presence_app_token"),"Content-type":"application/json; charset=UTF-8"}}).then((e=>401==e.status?{redirectTo:"Login"}:e.json()))}}},184:function(e,a,t){t.r(a),t.d(a,{default:function(){return D}});var i=t(6760),s=t(8752);const l={class:"grid"},o={class:"col-12"},n={class:"card"},r={class:"my-2"},d={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},c=(0,i.QD)("h5",{class:"m-0"},"Manajemen Cuti",-1),p={class:"block mt-2 md:mt-0 p-input-icon-left"},h=(0,i.QD)("i",{class:"pi pi-search"},null,-1),u=(0,i.QD)("span",{class:"p-column-title"},"ID",-1),m={class:"field"},v=(0,i.QD)("label",{for:"name"},"Nama",-1),g={key:0,class:"p-invalid"};function L(e,a,t,L,f,P){const b=(0,i.E1)("Button"),k=(0,i.E1)("Toolbar"),y=(0,i.E1)("InputText"),D=(0,i.E1)("Column"),S=(0,i.E1)("DataTable"),w=(0,i.E1)("Dialog");return(0,i.Wz)(),(0,i.An)("div",l,[(0,i.QD)("div",o,[(0,i.QD)("div",n,[(0,i.K2)(k,{class:"mb-4"},{start:(0,i.Ql)((()=>[(0,i.QD)("div",r,[(0,i.K2)(b,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:P.openNew},null,8,["onClick"])])])),_:1}),(0,i.K2)(S,{value:f.paidLeaves,lazy:!0,paginator:!0,rows:10,filters:f.filters,"onUpdate:filters":a[1]||(a[1]=e=>f.filters=e),ref:"dt",dataKey:"id",totalRecords:f.totalRecords,loading:f.loading,onPage:a[2]||(a[2]=e=>P.onPage(e)),onSort:a[3]||(a[3]=e=>P.onSort(e)),onFilter:a[4]||(a[4]=e=>P.onFilter(e)),globalFilterFields:["name"],selection:e.selectedCustomers,"onUpdate:selection":a[5]||(a[5]=a=>e.selectedCustomers=a),selectAll:f.selectAll,onSelectAllChange:P.onSelectAllChange,onRowSelect:P.onRowSelect,onRowUnselect:P.onRowUnselect,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll"},{header:(0,i.Ql)((()=>[(0,i.QD)("div",d,[c,(0,i.QD)("span",p,[h,(0,i.K2)(y,{modelValue:f.filters["global"].value,"onUpdate:modelValue":a[0]||(a[0]=e=>f.filters["global"].value=e),placeholder:"Search...",onKeyup:P.onFilter},null,8,["modelValue","onKeyup"])])])])),default:(0,i.Ql)((()=>[(0,i.K2)(D,{field:"id",header:"ID",sortable:!0},{body:(0,i.Ql)((e=>[u,(0,i.mY)(" "+(0,s.WA)(e.data.id),1)])),_:1}),(0,i.K2)(D,{field:"name",header:"Nama"}),(0,i.K2)(D,{header:"Aksi"},{body:(0,i.Ql)((e=>[(0,i.K2)(b,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:a=>P.editPaidLeave(e.data)},null,8,["onClick"]),e.data.id?((0,i.Wz)(),(0,i.Az)(b,{key:0,icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:a=>P.confirmDelete(e.data)},null,8,["onClick"])):(0,i.g1)("",!0)])),_:1})])),_:1},8,["value","filters","totalRecords","loading","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"]),(0,i.K2)(w,{visible:f.paidLeaveDialog,"onUpdate:visible":a[7]||(a[7]=e=>f.paidLeaveDialog=e),style:{width:"450px"},header:"Form Cuti",modal:!0,class:"p-fluid"},{footer:(0,i.Ql)((()=>[(0,i.K2)(b,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:P.hideDialog},null,8,["onClick"]),(0,i.K2)(b,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:P.savePaidLeave},null,8,["onClick"])])),default:(0,i.Ql)((()=>[(0,i.QD)("div",m,[v,(0,i.K2)(y,{id:"name",modelValue:f.paidLeave.name,"onUpdate:modelValue":a[6]||(a[6]=e=>f.paidLeave.name=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:(0,s.WN)({"p-invalid":f.submitted&&!f.paidLeave.name})},null,8,["modelValue","class"]),f.submitted&&!f.paidLeave.name?((0,i.Wz)(),(0,i.An)("small",g,"Nama diperlukan.")):(0,i.g1)("",!0)])])),_:1},8,["visible"])])])])}t(3248);var f=t(5112),P=t(9208),b={data(){return{loading:!1,onsearchtimeout:null,totalRecords:0,paidLeaves:null,paidLeave:{},selectedPaidLeaves:null,selectAll:!1,filters:{},lazyParams:{},columns:[{field:"id",header:"ID"},{field:"name",header:"Nama"},{field:"date",header:"Tanggal"}],paidLeaveDialog:!1,submitted:!1}},PaidLeaveService:null,created(){this.PaidLeaveService=new P.c,this.initFilters()},mounted(){this.loading=!0,this.lazyParams={first:0,page:0,rows:this.$refs.dt.rows,sortField:null,sortOrder:1,filters:this.filters},this.loadLazyData()},methods:{openNew(){this.paidLeave={},this.submitted=!1,this.paidLeaveDialog=!0},loadLazyData(){this.loading=!0,setTimeout((()=>{this.PaidLeaveService.getPaidLeaves(this.lazyParams).then((e=>{"redirectTo"in e&&(localStorage.removeItem("presence_app_token"),localStorage.removeItem("presence_app_role"),this.$router.push(e.redirectTo)),this.paidLeaves=e.data,this.totalRecords=e.total,this.loading=!1}))}),1e3*Math.random()+250)},onPage(e){this.lazyParams=e,this.loadLazyData()},onSort(e){var a=this.lazyParams.page;this.lazyParams=e,this.lazyParams.page=a,this.loadLazyData()},onFilter(){this.onsearchtimeout&&clearTimeout(this.onsearchtimeout),this.onsearchtimeout=setTimeout((()=>{this.lazyParams.filters=this.filters,this.loadLazyData()}),1e3)},onSelectAllChange(e){const a=e.checked;a?this.PaidLeaveService.getPaidLeaves().then((e=>{"redirectTo"in e&&(localStorage.removeItem("presence_app_token"),localStorage.removeItem("presence_app_role"),this.$router.push(e.redirectTo)),this.selectAll=!0,this.selectedPaidLeaves=e.data})):(this.selectAll=!1,this.selectedPaidLeaves=[])},onRowSelect(){this.selectAll=this.selectedPaidLeaves.length===this.totalRecords},onRowUnselect(){this.selectAll=!1},editPaidLeave(e){this.paidLeave=e,this.paidLeaveDialog=!0},confirmDelete(e){this.paidLeave=e,this.$swal({title:"Apakah anda yakin akan menghapus data ini ?",showCancelButton:!0,confirmButtonText:"Hapus"}).then((e=>{e.isConfirmed&&this.PaidLeaveService.deletePaidLeave(this.paidLeave).then((e=>{e.success?(this.paidLeaves=this.paidLeaves.filter((e=>e.id!==this.paidLeave.id)),this.$swal({icon:"success",title:"Success",text:e.message}),this.paidLeaveDialog=!1,this.paidLeave={}):this.$swal({icon:"error",title:"Oops...",text:e.message})}))}))},hideDialog(){this.paidLeaveDialog=!1,this.submitted=!1},savePaidLeave(){this.submitted=!0,this.paidLeave.id?this.PaidLeaveService.updatePaidLeave(this.paidLeave).then((e=>{e.success?(this.loadLazyData(),this.$swal({icon:"success",title:"Success",text:e.message}),this.paidLeaveDialog=!1,this.paidLeave={}):this.$swal({icon:"error",title:"Oops...",text:e.message})})):this.PaidLeaveService.createPaidLeave(this.paidLeave).then((e=>{e.success?(this.loadLazyData(),this.paidLeaveDialog=!1,this.paidLeave={},this.$swal({icon:"success",title:"Success",text:e.message})):this.$swal({icon:"error",title:"Oops...",text:e.message})}))},findIndexById(e){let a=-1;for(let t=0;t<this.paidLeaves.length;t++)if(this.paidLeaves[t].id===e){a=t;break}return a},initFilters(){this.filters={global:{value:null,matchMode:f.yI.CONTAINS}}}}},k=t(8152);const y=(0,k.c)(b,[["render",L]]);var D=y}}]);
//# sourceMappingURL=184.36d9d82a.js.map